---
date: "2019-08-21T11:00:29+02:00"
title: Time analyses
weight: 13
---



<p>The next section of the template produces analyses and outputs related to time, such as epidemic curves.</p>
<div id="basic-epidemic-curve" class="section level3">
<h3>Basic epidemic curve</h3>
<p>The first half of this code chunk (<code>epicurve</code>) is about setting-up the data for the epidemic curves.</p>
<p><strong>First</strong>, the function <code>incidence()</code> <strong>counts the number of cases</strong> for each week, by <code>date_of_onset</code>. It stores this information in the object <code>inc_week_7</code>. Read more about <code>incidence()</code> in the Help pane.</p>
<p><strong>Second</strong>, the <strong>theme elements</strong> are set that <code>ggplot()</code> will use when plotting the epidemic curves (you can read more about <code>ggplot()</code> and theme elements in the Advanced R Basics page). This includes the angle and placement of x-axis label text, having no title in the legend, and setting colors and type for x and y gridlines.</p>
<p><strong>Third</strong>, the <strong>text labels</strong> for the x and y axes, title, and subtitle (subtitle automatically using the <code>reporting_week</code> defined at the top of the template). These are stored in the object <code>epicurve_labels</code>.</p>
<p>{{% notice tip %}}
It is necessary to use the “full name” of variables for this to work correctly - this means date_of_onset should be listed in incidence() as <code>linelist_cleaned$date_of_onset</code>.
{{% /notice %}}</p>
<pre class="r"><code># This code creates case counts for each week of your outbreak, overall
# As with aweek, you can change the start of your week to e.g. &quot;Sunday week&quot;
inc_week_7 &lt;- incidence(linelist_cleaned$date_of_onset, interval = &quot;Monday week&quot;)

# this sets the theme in ggplot for epicurves
epicurve_theme &lt;- theme(
  axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1), 
  legend.title = element_blank(),
  panel.grid.major.x = element_line(color = &quot;grey60&quot;, linetype = 3),
  panel.grid.major.y = element_line(color = &quot;grey60&quot;, linetype = 3)
)

# This sets the labels in ggplot for the epicurves
epicurve_labels &lt;- labs(x = &quot;Calendar week&quot;, 
                        y = &quot;Cases (n)&quot;, 
                        title = &quot;Cases by week of onset&quot;,
                        subtitle = str_glue(&quot;Source: MSF data from {reporting_week}&quot;)
                       ) </code></pre>
<p><strong>In this next part of the chunk, the plot of the epidemic curve is finalized and displayed.</strong></p>
<p>{{% notice tip %}}
The <code>plot()</code> function used here is from the package <strong>incidence</strong>, not the base R <code>plot()</code> function. This one uses <code>ggplot()</code> and so has different syntax and structure. As with <code>ggplot()</code>, layers of the graphic are added sequentially using the <code>+</code> symbol at the end of each sub-command.
{{% /notice %}}</p>
<p>In the example below, the weekly count data from <code>inc_week_7</code> are plotted first, then miscellaneous settings are specified: the y-axis origin is set, the labels, and finally the theme parameters. All of these elements are stored in the object <code>basic_curve</code>, which is finally run to display the plot.</p>
<p>{{% notice tip %}}
For some functions, it is necessary to use the “full name” of variables - for example when using <code>incidence()</code>, <code>date_of_onset</code> should be listed as <code>linelist_cleaned$date_of_onset</code>. Otherwise you may get an error such as “object ‘date_of_onset’ not found”.
{{% /notice %}}</p>
<pre class="r"><code># plot your epicurve as a ggplot (incidence::plot is different to base::plot)
basic_curve &lt;- plot(inc_week_7, show_cases = TRUE, border = &quot;black&quot;, n_breaks = nrow(inc_week_7)) + 
  scale_y_continuous(expand = c(0, 0)) +  # set origin for axes
  # add labels to axes and below chart
  epicurve_labels +
  # change visuals of dates and remove legend title
  epicurve_theme
# show your plot (stored for later use) 
basic_curve</code></pre>
<p><img src="/training/Walk-through/time_analyses_files/figure-html/epicurve-1.png" width="720" /></p>
<p>This x-axis is difficult to read with every week displayed. To increase readability we can uncomment and use the helper code at the bottom of that code chunk. This modifies the already-defined <code>basic_curve</code> object (with a <code>+</code>) to specify that the x-axis shows only a specified number of breaks/dates (in this case 6). Note: A warning that a scale for x is being replaced is okay.</p>
<p>{{% notice tip %}}
The data are still shown by week - it is only the labels on the scale that have changed.
{{% /notice %}}</p>
<pre class="r"><code># Modifies basic_curve to show only 6 breaks in the x-axis 
basic_curve + scale_x_incidence(inc_week_7, n_breaks = 6)</code></pre>
<p><img src="/training/Walk-through/time_analyses_files/figure-html/unnamed-chunk-1-1.png" width="720" /></p>
<p><strong>To change the intervals used for the data aggregation themselves</strong>, use the <code>interval =</code> argument in the original <code>incidence()</code> command. There are the options to do this biweekly, by month, quarter or year (search the Help pane for the <code>incidence()</code> function in the <strong>incidence</strong> package). <strong>Below is a biweekly example</strong> (the axes labels have been returned to default - showing each two-week increment).</p>
<p>{{% notice tip %}}
In the code below, the plot is not saved to an object and simply prints when the <code>plot()</code> command and it’s various added (<code>+</code>) elements such as scale, labels, and theme are run.
{{% /notice %}}</p>
<pre class="r"><code># interval is set to &quot;2 Monday weeks&quot; for biweekly case aggregation
inc_week_14 &lt;- incidence(linelist_cleaned$date_of_onset, interval = &quot;2 Monday weeks&quot;)

# plot the epicurve
plot(inc_week_14, show_cases = TRUE, border = &quot;black&quot;, n_breaks = nrow(inc_week_14)) + 
  scale_y_continuous(expand = c(0,0)) +  # set origin for axes
  # add labels to axes and below chart
  epicurve_labels +
  # change visuals of dates and remove legend title
  epicurve_theme</code></pre>
<p><img src="/training/Walk-through/time_analyses_files/figure-html/biweekly_epicurve-1.png" width="720" /></p>
<p>To <strong>stratify the epidemic curve</strong> by a categorical variable (such as gender), the <code>groups =</code> argument is added to the <code>incidence()</code> function. Additionally, the <code>show_cases =</code> argument of <code>plot()</code> can be set to <code>FALSE</code> to improve aesthetics.</p>
<p>{{% notice tip %}}
Remember that if listing a variable, the <code>incidence()</code> function expects its “full name”, such as <code>linelist_cleaned$sex</code>**. Otherwise you may get an error such as “object ‘sex’ not found”.
{{% /notice %}}</p>
<pre class="r"><code># get counts by gender
inc_week_7_gender &lt;- incidence(linelist_cleaned$date_of_onset, 
                               interval = &quot;2 Monday weeks&quot;, 
                               groups = linelist_cleaned$sex)
# plot your epicurve
# here we remove the boxes around each case as it makes gender colours hard to see! (show_cases = FALSE)
plot(inc_week_7_gender, show_cases = FALSE, border = &quot;black&quot;, n_breaks = nrow(inc_week_7_gender)) + 
  scale_y_continuous(expand = c(0,0)) +  # set origin for axes
  # add labels to axes and below chart
  epicurve_labels +
  # change visuals of dates, remove legend title and move legend to bottom
  epicurve_theme</code></pre>
<p><img src="/training/Walk-through/time_analyses_files/figure-html/incidence_by_gender-1.png" width="720" /></p>
<p>Lastly, we can <strong>limit the entire plot to a subset of observations</strong> by first filtering the dataset and passing the result to the <code>incidence()</code> function.</p>
<p>In the example below, <code>incidence()</code> operates upon a filtered version of <code>linelist_cleaned</code> that only includes inpatients. The resulting object is used, as before, in <code>plot()</code> in the step below.</p>
<pre class="r"><code># filter the dataset and pass it to the incidence() function
inc_week_7_sex_fac &lt;- linelist_cleaned %&gt;%
  filter(patient_facility_type == &quot;Inpatient&quot;) %&gt;%
  with(incidence(date_of_onset, interval = &quot;2 Monday weeks&quot;, groups = sex))

# plot as before
plot(inc_week_7_sex_fac, show_cases = TRUE, border = &quot;black&quot;, n_breaks = nrow(inc_week_7_sex_fac)) + 
  scale_y_continuous(expand = c(0, 0)) +  # set origin for axes
  # add labels to axes and below chart
  epicurve_labels +
  # change visuals of dates, remove legend title and move legend to bottom
  epicurve_theme</code></pre>
<p><img src="/training/Walk-through/time_analyses_files/figure-html/incidence_by_sex_facility-1.png" width="720" /></p>
</div>
<div id="analysis-of-other-indicators-by-time" class="section level3">
<h3>Analysis of other indicators by time</h3>
<div id="attack-rate-by-week" class="section level4">
<h4>Attack rate by week</h4>
<p>The code below produces a table of the attack rates by epiweek.</p>
<p><strong>First</strong>, the object <code>cases</code> is defined as linelist observations counted and arranged/ordered by epiweek, accompanied by a cumulative sum column.</p>
<p><strong>Second</strong>, the object <code>ar</code> is defined using the <code>attack_rate()</code> function, which looks with <code>cases</code> at counts for each week (column “n”) and the denominator <code>population</code>, which was defined earlier as the sum of the regional populations (62336). The rate multiplier is set to 10000 but is changeable. The epiweeks are also attached to <code>ar</code> as a column.</p>
<p><strong>Third</strong>, aesthetic operations are done to <code>ar</code> to improve column names. Finally, the table is produced with <code>kable()</code>.</p>
<pre class="r"><code># counts and cumulative counts by week
cases &lt;- linelist_cleaned %&gt;%
  arrange(date_of_onset) %&gt;%        # arrange by date of onset
  count(epiweek, .drop = FALSE) %&gt;% # count all epiweeks and include zero counts
  mutate(cumulative = cumsum(n))    # add a cumulative sum

# attack rate for each week
ar &lt;- attack_rate(cases$n, population, multiplier = 10000) %&gt;% 
  bind_cols(select(cases, epiweek), .) # add the epiweek column to table

# Display the table
ar %&gt;%
  merge_ci_df(e = 4) %&gt;% # merge the lower and upper CI into one column
  rename(&quot;Epiweek&quot; = epiweek, 
         &quot;Cases (n)&quot; = cases, 
         &quot;Population&quot; = population, 
         &quot;AR (per 10,000)&quot; = ar, 
         &quot;95%CI&quot; = ci) %&gt;% 
  knitr::kable(digits = 1, align = &quot;r&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Epiweek</th>
<th align="right">Cases (n)</th>
<th align="right">Population</th>
<th align="right">AR (per 10,000)</th>
<th align="right">95%CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2016-W23</td>
<td align="right">1</td>
<td align="right">62336</td>
<td align="right">0.2</td>
<td align="right">(0.03–0.91)</td>
</tr>
<tr class="even">
<td align="right">2016-W24</td>
<td align="right">0</td>
<td align="right">62336</td>
<td align="right">0.0</td>
<td align="right">(0.00–0.62)</td>
</tr>
<tr class="odd">
<td align="right">2016-W25</td>
<td align="right">0</td>
<td align="right">62336</td>
<td align="right">0.0</td>
<td align="right">(0.00–0.62)</td>
</tr>
<tr class="even">
<td align="right">2016-W26</td>
<td align="right">0</td>
<td align="right">62336</td>
<td align="right">0.0</td>
<td align="right">(0.00–0.62)</td>
</tr>
<tr class="odd">
<td align="right">2016-W27</td>
<td align="right">0</td>
<td align="right">62336</td>
<td align="right">0.0</td>
<td align="right">(0.00–0.62)</td>
</tr>
<tr class="even">
<td align="right">2016-W28</td>
<td align="right">0</td>
<td align="right">62336</td>
<td align="right">0.0</td>
<td align="right">(0.00–0.62)</td>
</tr>
<tr class="odd">
<td align="right">2016-W29</td>
<td align="right">1</td>
<td align="right">62336</td>
<td align="right">0.2</td>
<td align="right">(0.03–0.91)</td>
</tr>
<tr class="even">
<td align="right">2016-W30</td>
<td align="right">2</td>
<td align="right">62336</td>
<td align="right">0.3</td>
<td align="right">(0.09–1.17)</td>
</tr>
<tr class="odd">
<td align="right">2016-W31</td>
<td align="right">0</td>
<td align="right">62336</td>
<td align="right">0.0</td>
<td align="right">(0.00–0.62)</td>
</tr>
<tr class="even">
<td align="right">2016-W32</td>
<td align="right">0</td>
<td align="right">62336</td>
<td align="right">0.0</td>
<td align="right">(0.00–0.62)</td>
</tr>
<tr class="odd">
<td align="right">2016-W33</td>
<td align="right">3</td>
<td align="right">62336</td>
<td align="right">0.5</td>
<td align="right">(0.16–1.42)</td>
</tr>
<tr class="even">
<td align="right">2016-W34</td>
<td align="right">7</td>
<td align="right">62336</td>
<td align="right">1.1</td>
<td align="right">(0.54–2.32)</td>
</tr>
<tr class="odd">
<td align="right">2016-W35</td>
<td align="right">1</td>
<td align="right">62336</td>
<td align="right">0.2</td>
<td align="right">(0.03–0.91)</td>
</tr>
<tr class="even">
<td align="right">2016-W36</td>
<td align="right">2</td>
<td align="right">62336</td>
<td align="right">0.3</td>
<td align="right">(0.09–1.17)</td>
</tr>
<tr class="odd">
<td align="right">2016-W37</td>
<td align="right">17</td>
<td align="right">62336</td>
<td align="right">2.7</td>
<td align="right">(1.70–4.37)</td>
</tr>
<tr class="even">
<td align="right">2016-W38</td>
<td align="right">12</td>
<td align="right">62336</td>
<td align="right">1.9</td>
<td align="right">(1.10–3.36)</td>
</tr>
<tr class="odd">
<td align="right">2016-W39</td>
<td align="right">9</td>
<td align="right">62336</td>
<td align="right">1.4</td>
<td align="right">(0.76–2.74)</td>
</tr>
<tr class="even">
<td align="right">2016-W40</td>
<td align="right">10</td>
<td align="right">62336</td>
<td align="right">1.6</td>
<td align="right">(0.87–2.95)</td>
</tr>
<tr class="odd">
<td align="right">2016-W41</td>
<td align="right">3</td>
<td align="right">62336</td>
<td align="right">0.5</td>
<td align="right">(0.16–1.42)</td>
</tr>
<tr class="even">
<td align="right">2016-W42</td>
<td align="right">5</td>
<td align="right">62336</td>
<td align="right">0.8</td>
<td align="right">(0.34–1.88)</td>
</tr>
<tr class="odd">
<td align="right">2016-W43</td>
<td align="right">5</td>
<td align="right">62336</td>
<td align="right">0.8</td>
<td align="right">(0.34–1.88)</td>
</tr>
<tr class="even">
<td align="right">2016-W44</td>
<td align="right">3</td>
<td align="right">62336</td>
<td align="right">0.5</td>
<td align="right">(0.16–1.42)</td>
</tr>
<tr class="odd">
<td align="right">2016-W45</td>
<td align="right">5</td>
<td align="right">62336</td>
<td align="right">0.8</td>
<td align="right">(0.34–1.88)</td>
</tr>
<tr class="even">
<td align="right">2016-W46</td>
<td align="right">12</td>
<td align="right">62336</td>
<td align="right">1.9</td>
<td align="right">(1.10–3.36)</td>
</tr>
<tr class="odd">
<td align="right">2016-W47</td>
<td align="right">13</td>
<td align="right">62336</td>
<td align="right">2.1</td>
<td align="right">(1.22–3.57)</td>
</tr>
<tr class="even">
<td align="right">2016-W48</td>
<td align="right">23</td>
<td align="right">62336</td>
<td align="right">3.7</td>
<td align="right">(2.46–5.54)</td>
</tr>
<tr class="odd">
<td align="right">2016-W49</td>
<td align="right">19</td>
<td align="right">62336</td>
<td align="right">3.0</td>
<td align="right">(1.95–4.76)</td>
</tr>
<tr class="even">
<td align="right">2016-W50</td>
<td align="right">35</td>
<td align="right">62336</td>
<td align="right">5.6</td>
<td align="right">(4.04–7.81)</td>
</tr>
<tr class="odd">
<td align="right">2016-W51</td>
<td align="right">22</td>
<td align="right">62336</td>
<td align="right">3.5</td>
<td align="right">(2.33–5.34)</td>
</tr>
<tr class="even">
<td align="right">2016-W52</td>
<td align="right">31</td>
<td align="right">62336</td>
<td align="right">5.0</td>
<td align="right">(3.50–7.06)</td>
</tr>
<tr class="odd">
<td align="right">2017-W01</td>
<td align="right">16</td>
<td align="right">62336</td>
<td align="right">2.6</td>
<td align="right">(1.58–4.17)</td>
</tr>
<tr class="even">
<td align="right">2017-W02</td>
<td align="right">22</td>
<td align="right">62336</td>
<td align="right">3.5</td>
<td align="right">(2.33–5.34)</td>
</tr>
<tr class="odd">
<td align="right">2017-W03</td>
<td align="right">14</td>
<td align="right">62336</td>
<td align="right">2.2</td>
<td align="right">(1.34–3.77)</td>
</tr>
<tr class="even">
<td align="right">2017-W04</td>
<td align="right">20</td>
<td align="right">62336</td>
<td align="right">3.2</td>
<td align="right">(2.08–4.96)</td>
</tr>
<tr class="odd">
<td align="right">2017-W05</td>
<td align="right">16</td>
<td align="right">62336</td>
<td align="right">2.6</td>
<td align="right">(1.58–4.17)</td>
</tr>
<tr class="even">
<td align="right">2017-W06</td>
<td align="right">118</td>
<td align="right">62336</td>
<td align="right">18.9</td>
<td align="right">(15.81–22.66)</td>
</tr>
<tr class="odd">
<td align="right">2017-W07</td>
<td align="right">20</td>
<td align="right">62336</td>
<td align="right">3.2</td>
<td align="right">(2.08–4.96)</td>
</tr>
<tr class="even">
<td align="right">2017-W08</td>
<td align="right">41</td>
<td align="right">62336</td>
<td align="right">6.6</td>
<td align="right">(4.85–8.92)</td>
</tr>
<tr class="odd">
<td align="right">2017-W09</td>
<td align="right">15</td>
<td align="right">62336</td>
<td align="right">2.4</td>
<td align="right">(1.46–3.97)</td>
</tr>
<tr class="even">
<td align="right">2017-W10</td>
<td align="right">39</td>
<td align="right">62336</td>
<td align="right">6.3</td>
<td align="right">(4.58–8.55)</td>
</tr>
<tr class="odd">
<td align="right">2017-W11</td>
<td align="right">8</td>
<td align="right">62336</td>
<td align="right">1.3</td>
<td align="right">(0.65–2.53)</td>
</tr>
<tr class="even">
<td align="right">2017-W12</td>
<td align="right">14</td>
<td align="right">62336</td>
<td align="right">2.2</td>
<td align="right">(1.34–3.77)</td>
</tr>
<tr class="odd">
<td align="right">2017-W13</td>
<td align="right">8</td>
<td align="right">62336</td>
<td align="right">1.3</td>
<td align="right">(0.65–2.53)</td>
</tr>
<tr class="even">
<td align="right">2017-W14</td>
<td align="right">11</td>
<td align="right">62336</td>
<td align="right">1.8</td>
<td align="right">(0.99–3.16)</td>
</tr>
<tr class="odd">
<td align="right">2017-W15</td>
<td align="right">3</td>
<td align="right">62336</td>
<td align="right">0.5</td>
<td align="right">(0.16–1.42)</td>
</tr>
<tr class="even">
<td align="right">2017-W16</td>
<td align="right">5</td>
<td align="right">62336</td>
<td align="right">0.8</td>
<td align="right">(0.34–1.88)</td>
</tr>
<tr class="odd">
<td align="right">-</td>
<td align="right">825</td>
<td align="right">62336</td>
<td align="right">132.3</td>
<td align="right">(123.67–141.62)</td>
</tr>
</tbody>
</table>
<p>This code produces the <em>cumulative</em> attack rate, by week. In the <code>attack_rate()</code> command it references the <code>cases$cumulative</code> column, instead of <code>cases$n column</code>.</p>
<pre class="r"><code># cumulative attack rate by week
attack_rate(cases$cumulative, population, multiplier = 10000) %&gt;% 
  bind_cols(select(cases, epiweek), .) %&gt;% # add the epiweek column to table
  merge_ci_df(e = 4) %&gt;% # merge the lower and upper CI into one column
  rename(&quot;Epiweek&quot; = epiweek, 
         &quot;Cases (n)&quot; = cases, 
         &quot;Population&quot; = population, 
         &quot;AR (per 10,000)&quot; = ar, 
         &quot;95%CI&quot; = ci) %&gt;% 
  knitr::kable(digits = 1, align = &quot;r&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Epiweek</th>
<th align="right">Cases (n)</th>
<th align="right">Population</th>
<th align="right">AR (per 10,000)</th>
<th align="right">95%CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2016-W23</td>
<td align="right">1</td>
<td align="right">62336</td>
<td align="right">0.2</td>
<td align="right">(0.03–0.91)</td>
</tr>
<tr class="even">
<td align="right">2016-W24</td>
<td align="right">1</td>
<td align="right">62336</td>
<td align="right">0.2</td>
<td align="right">(0.03–0.91)</td>
</tr>
<tr class="odd">
<td align="right">2016-W25</td>
<td align="right">1</td>
<td align="right">62336</td>
<td align="right">0.2</td>
<td align="right">(0.03–0.91)</td>
</tr>
<tr class="even">
<td align="right">2016-W26</td>
<td align="right">1</td>
<td align="right">62336</td>
<td align="right">0.2</td>
<td align="right">(0.03–0.91)</td>
</tr>
<tr class="odd">
<td align="right">2016-W27</td>
<td align="right">1</td>
<td align="right">62336</td>
<td align="right">0.2</td>
<td align="right">(0.03–0.91)</td>
</tr>
<tr class="even">
<td align="right">2016-W28</td>
<td align="right">1</td>
<td align="right">62336</td>
<td align="right">0.2</td>
<td align="right">(0.03–0.91)</td>
</tr>
<tr class="odd">
<td align="right">2016-W29</td>
<td align="right">2</td>
<td align="right">62336</td>
<td align="right">0.3</td>
<td align="right">(0.09–1.17)</td>
</tr>
<tr class="even">
<td align="right">2016-W30</td>
<td align="right">4</td>
<td align="right">62336</td>
<td align="right">0.6</td>
<td align="right">(0.25–1.65)</td>
</tr>
<tr class="odd">
<td align="right">2016-W31</td>
<td align="right">4</td>
<td align="right">62336</td>
<td align="right">0.6</td>
<td align="right">(0.25–1.65)</td>
</tr>
<tr class="even">
<td align="right">2016-W32</td>
<td align="right">4</td>
<td align="right">62336</td>
<td align="right">0.6</td>
<td align="right">(0.25–1.65)</td>
</tr>
<tr class="odd">
<td align="right">2016-W33</td>
<td align="right">7</td>
<td align="right">62336</td>
<td align="right">1.1</td>
<td align="right">(0.54–2.32)</td>
</tr>
<tr class="even">
<td align="right">2016-W34</td>
<td align="right">14</td>
<td align="right">62336</td>
<td align="right">2.2</td>
<td align="right">(1.34–3.77)</td>
</tr>
<tr class="odd">
<td align="right">2016-W35</td>
<td align="right">15</td>
<td align="right">62336</td>
<td align="right">2.4</td>
<td align="right">(1.46–3.97)</td>
</tr>
<tr class="even">
<td align="right">2016-W36</td>
<td align="right">17</td>
<td align="right">62336</td>
<td align="right">2.7</td>
<td align="right">(1.70–4.37)</td>
</tr>
<tr class="odd">
<td align="right">2016-W37</td>
<td align="right">34</td>
<td align="right">62336</td>
<td align="right">5.5</td>
<td align="right">(3.90–7.62)</td>
</tr>
<tr class="even">
<td align="right">2016-W38</td>
<td align="right">46</td>
<td align="right">62336</td>
<td align="right">7.4</td>
<td align="right">(5.53–9.84)</td>
</tr>
<tr class="odd">
<td align="right">2016-W39</td>
<td align="right">55</td>
<td align="right">62336</td>
<td align="right">8.8</td>
<td align="right">(6.78–11.48)</td>
</tr>
<tr class="even">
<td align="right">2016-W40</td>
<td align="right">65</td>
<td align="right">62336</td>
<td align="right">10.4</td>
<td align="right">(8.18–13.29)</td>
</tr>
<tr class="odd">
<td align="right">2016-W41</td>
<td align="right">68</td>
<td align="right">62336</td>
<td align="right">10.9</td>
<td align="right">(8.61–13.83)</td>
</tr>
<tr class="even">
<td align="right">2016-W42</td>
<td align="right">73</td>
<td align="right">62336</td>
<td align="right">11.7</td>
<td align="right">(9.32–14.72)</td>
</tr>
<tr class="odd">
<td align="right">2016-W43</td>
<td align="right">78</td>
<td align="right">62336</td>
<td align="right">12.5</td>
<td align="right">(10.03–15.61)</td>
</tr>
<tr class="even">
<td align="right">2016-W44</td>
<td align="right">81</td>
<td align="right">62336</td>
<td align="right">13.0</td>
<td align="right">(10.46–16.15)</td>
</tr>
<tr class="odd">
<td align="right">2016-W45</td>
<td align="right">86</td>
<td align="right">62336</td>
<td align="right">13.8</td>
<td align="right">(11.17–17.03)</td>
</tr>
<tr class="even">
<td align="right">2016-W46</td>
<td align="right">98</td>
<td align="right">62336</td>
<td align="right">15.7</td>
<td align="right">(12.90–19.15)</td>
</tr>
<tr class="odd">
<td align="right">2016-W47</td>
<td align="right">111</td>
<td align="right">62336</td>
<td align="right">17.8</td>
<td align="right">(14.79–21.44)</td>
</tr>
<tr class="even">
<td align="right">2016-W48</td>
<td align="right">134</td>
<td align="right">62336</td>
<td align="right">21.5</td>
<td align="right">(18.15–25.45)</td>
</tr>
<tr class="odd">
<td align="right">2016-W49</td>
<td align="right">153</td>
<td align="right">62336</td>
<td align="right">24.5</td>
<td align="right">(20.95–28.75)</td>
</tr>
<tr class="even">
<td align="right">2016-W50</td>
<td align="right">188</td>
<td align="right">62336</td>
<td align="right">30.2</td>
<td align="right">(26.15–34.78)</td>
</tr>
<tr class="odd">
<td align="right">2016-W51</td>
<td align="right">210</td>
<td align="right">62336</td>
<td align="right">33.7</td>
<td align="right">(29.44–38.55)</td>
</tr>
<tr class="even">
<td align="right">2016-W52</td>
<td align="right">241</td>
<td align="right">62336</td>
<td align="right">38.7</td>
<td align="right">(34.09–43.85)</td>
</tr>
<tr class="odd">
<td align="right">2017-W01</td>
<td align="right">257</td>
<td align="right">62336</td>
<td align="right">41.2</td>
<td align="right">(36.49–46.57)</td>
</tr>
<tr class="even">
<td align="right">2017-W02</td>
<td align="right">279</td>
<td align="right">62336</td>
<td align="right">44.8</td>
<td align="right">(39.81–50.31)</td>
</tr>
<tr class="odd">
<td align="right">2017-W03</td>
<td align="right">293</td>
<td align="right">62336</td>
<td align="right">47.0</td>
<td align="right">(41.93–52.69)</td>
</tr>
<tr class="even">
<td align="right">2017-W04</td>
<td align="right">313</td>
<td align="right">62336</td>
<td align="right">50.2</td>
<td align="right">(44.96–56.07)</td>
</tr>
<tr class="odd">
<td align="right">2017-W05</td>
<td align="right">329</td>
<td align="right">62336</td>
<td align="right">52.8</td>
<td align="right">(47.39–58.78)</td>
</tr>
<tr class="even">
<td align="right">2017-W06</td>
<td align="right">447</td>
<td align="right">62336</td>
<td align="right">71.7</td>
<td align="right">(65.38–78.64)</td>
</tr>
<tr class="odd">
<td align="right">2017-W07</td>
<td align="right">467</td>
<td align="right">62336</td>
<td align="right">74.9</td>
<td align="right">(68.44–82.00)</td>
</tr>
<tr class="even">
<td align="right">2017-W08</td>
<td align="right">508</td>
<td align="right">62336</td>
<td align="right">81.5</td>
<td align="right">(74.73–88.86)</td>
</tr>
<tr class="odd">
<td align="right">2017-W09</td>
<td align="right">523</td>
<td align="right">62336</td>
<td align="right">83.9</td>
<td align="right">(77.04–91.37)</td>
</tr>
<tr class="even">
<td align="right">2017-W10</td>
<td align="right">562</td>
<td align="right">62336</td>
<td align="right">90.2</td>
<td align="right">(83.03–97.89)</td>
</tr>
<tr class="odd">
<td align="right">2017-W11</td>
<td align="right">570</td>
<td align="right">62336</td>
<td align="right">91.4</td>
<td align="right">(84.26–99.22)</td>
</tr>
<tr class="even">
<td align="right">2017-W12</td>
<td align="right">584</td>
<td align="right">62336</td>
<td align="right">93.7</td>
<td align="right">(86.42–101.56)</td>
</tr>
<tr class="odd">
<td align="right">2017-W13</td>
<td align="right">592</td>
<td align="right">62336</td>
<td align="right">95.0</td>
<td align="right">(87.65–102.89)</td>
</tr>
<tr class="even">
<td align="right">2017-W14</td>
<td align="right">603</td>
<td align="right">62336</td>
<td align="right">96.7</td>
<td align="right">(89.35–104.73)</td>
</tr>
<tr class="odd">
<td align="right">2017-W15</td>
<td align="right">606</td>
<td align="right">62336</td>
<td align="right">97.2</td>
<td align="right">(89.81–105.23)</td>
</tr>
<tr class="even">
<td align="right">2017-W16</td>
<td align="right">611</td>
<td align="right">62336</td>
<td align="right">98.0</td>
<td align="right">(90.58–106.06)</td>
</tr>
<tr class="odd">
<td align="right">-</td>
<td align="right">1436</td>
<td align="right">62336</td>
<td align="right">230.4</td>
<td align="right">(218.88–242.44)</td>
</tr>
</tbody>
</table>
<p>This next code chunk applies a filter for only inpatient observations. It also uses a different function, <code>case_fatality_rate_df()</code>, to produce a table showing deaths, cases, CFR, and CFR confidence intervals.</p>
<pre class="r"><code># group by known outcome and case definition 
cfr &lt;- linelist_cleaned %&gt;%
  filter(patient_facility_type == &quot;Inpatient&quot;) %&gt;%
  case_fatality_rate_df(grepl(&quot;Dead&quot;, exit_status), group = epiweek)


cfr %&gt;%
  merge_ci_df(e = 4) %&gt;% # merge the lower and upper CI into one column
  rename(&quot;Epiweek&quot; = epiweek, 
         &quot;Deaths&quot; = deaths, 
         &quot;Cases&quot; = population, 
         &quot;CFR (%)&quot; = cfr, 
         &quot;95%CI&quot; = ci) %&gt;% 
  knitr::kable(digits = 1, align = &quot;r&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Epiweek</th>
<th align="right">Deaths</th>
<th align="right">Cases</th>
<th align="right">CFR (%)</th>
<th align="right">95%CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2016-W23</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="even">
<td align="right">2016-W24</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="odd">
<td align="right">2016-W25</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="even">
<td align="right">2016-W26</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="odd">
<td align="right">2016-W27</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="even">
<td align="right">2016-W28</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="odd">
<td align="right">2016-W29</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="even">
<td align="right">2016-W30</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="odd">
<td align="right">2016-W31</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="even">
<td align="right">2016-W32</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="odd">
<td align="right">2016-W33</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="even">
<td align="right">2016-W34</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="odd">
<td align="right">2016-W35</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="even">
<td align="right">2016-W36</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="odd">
<td align="right">2016-W37</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">(0.00–48.99)</td>
</tr>
<tr class="even">
<td align="right">2016-W38</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">(0.00–56.15)</td>
</tr>
<tr class="odd">
<td align="right">2016-W39</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">(0.00–65.76)</td>
</tr>
<tr class="even">
<td align="right">2016-W40</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">(0.00–43.45)</td>
</tr>
<tr class="odd">
<td align="right">2016-W41</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="even">
<td align="right">2016-W42</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">(0.00–43.45)</td>
</tr>
<tr class="odd">
<td align="right">2016-W43</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="even">
<td align="right">2016-W44</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="odd">
<td align="right">2016-W45</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">(0.00–56.15)</td>
</tr>
<tr class="even">
<td align="right">2016-W46</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">(0.00–48.99)</td>
</tr>
<tr class="odd">
<td align="right">2016-W47</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="even">
<td align="right">2016-W48</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="odd">
<td align="right">2016-W49</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="even">
<td align="right">2016-W50</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="odd">
<td align="right">2016-W51</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="even">
<td align="right">2016-W52</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">(0.00–65.76)</td>
</tr>
<tr class="odd">
<td align="right">2017-W01</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">(0.00–65.76)</td>
</tr>
<tr class="even">
<td align="right">2017-W02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="odd">
<td align="right">2017-W03</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">(0.00–65.76)</td>
</tr>
<tr class="even">
<td align="right">2017-W04</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">(0.00–48.99)</td>
</tr>
<tr class="odd">
<td align="right">2017-W05</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="even">
<td align="right">2017-W06</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">(0.00–43.45)</td>
</tr>
<tr class="odd">
<td align="right">2017-W07</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="even">
<td align="right">2017-W08</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="odd">
<td align="right">2017-W09</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="even">
<td align="right">2017-W10</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="odd">
<td align="right">2017-W11</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="even">
<td align="right">2017-W12</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="odd">
<td align="right">2017-W13</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">(0.00–65.76)</td>
</tr>
<tr class="even">
<td align="right">2017-W14</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">(0.00–79.35)</td>
</tr>
<tr class="odd">
<td align="right">2017-W15</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="even">
<td align="right">2017-W16</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-</td>
<td align="right">(NaN–NaN)</td>
</tr>
<tr class="odd">
<td align="right">(Missing)</td>
<td align="right">0</td>
<td align="right">27</td>
<td align="right">0</td>
<td align="right">(0.00–12.46)</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting-ar-cfr-and-epidemic-curve-together" class="section level4">
<h4>Plotting AR, CFR, and Epidemic Curve together</h4>
<p>These code chunks produce plots of the AR (in the population), CFR (among inpatients only), and the AF and CFR as line graphs together with the Epidemic Curve.</p>
<p><strong>The first chunk, <code>ar_line_graph</code>, prepares a plot of attack rate by epiweek, but does not yet print it.</strong> You can print it alone by running a command of its name <code>ar_plot</code>.</p>
<p>{{% notice tip %}}
This <code>ar_plot</code> depends on you having already run the <code>attack_rate_per_week</code> chunk. If you have not, you may see “Error: epiweek not found”
{{% /notice %}}</p>
<pre class="r"><code>ar_plot &lt;- ggplot(ar, aes(x = week2date(epiweek) + (7 * 0.5), group = 1)) +
  geom_ribbon(aes(ymin = lower, ymax = upper), 
              color = &quot;blue&quot;, fill = &quot;blue&quot;, linetype = 2, alpha = 0.2, show.legend = FALSE) +
  geom_line(aes(y = ar), color = &quot;blue&quot;, show.legend = FALSE) +
  scale_y_continuous(expand = c(0, 0)) +  # set origin for axes
  # scale the x axis the same as the incidence curve. Expand forces it to align. 
  incidence::scale_x_incidence(inc_week_7, n_breaks = nrow(inc_week_7), expand = c(0, 7 * 1.5)) +
  # add labels to axes and below chart
  labs(x = &quot;Calendar week&quot;, y = &quot;AR [95% CI]&quot;, subtitle = &quot;Attack Rate (per 10,000)&quot;) + 
  # change visuals of dates and remove legend title
  epicurve_theme</code></pre>
<p><strong>The second code chunk, <code>cfr_line_graph</code> prepares a plot of CFR by epiweek, but also does not yet print it.</strong> You can print it alone by running a command with its name <code>cfr_plot</code>.</p>
<p>{{% notice tip %}}
This cfr_plot depends on you having already run the cfr_per_week chunk. If you have not, you may see “Error: epiweek not found”.
{{% /notice %}}</p>
<pre class="r"><code>cfr_plot &lt;- ggplot(cfr, aes(x = week2date(epiweek) + (7 * 0.5), group = 1)) +
  geom_ribbon(aes(ymin = lower, ymax = upper), 
              color = &quot;red&quot;, fill = &quot;red&quot;, linetype = 2, alpha = 0.2, show.legend = FALSE) +
  geom_line(aes(y = cfr), color = &quot;red&quot;, show.legend = FALSE) +
  scale_y_continuous(expand = c(0, 0)) +  # set origin for axes
  # scale the x axis the same as the incidence curve. Expand forces it to align. 
  incidence::scale_x_incidence(inc_week_7, n_breaks = nrow(inc_week_7), expand = c(0, 7 * 1.5)) +
  # add labels to axes and below chart
  labs(x = &quot;Calendar week&quot;, y = &quot;CFR [95% CI]&quot;, 
       subtitle = &quot;Case Fatality Ratio [95% CI] Among Inpatients&quot;) + 
  # change visuals of dates and remove legend title
  epicurve_theme </code></pre>
<p><strong>Adding the AR and CFR plots with an Epidemic Curve (chunk <code>epicurve_ar_cfr</code>)</strong> and plotting them all together is now possible with the function <code>cowplot()</code>, which nicely combines different plots. You can read more about <code>cowplot()</code> in the Advanced and Miscellaneous R Basics page.</p>
<pre class="r"><code># Define no specified axis text or title over the combined plot
nofx &lt;- theme(axis.text.x = element_blank(),
              axis.title.x = element_blank())

# Combine the three plots together
cowplot::plot_grid(
  basic_curve + nofx,
  ar_plot + nofx,
  cfr_plot,
  align = &quot;v&quot;, # align plots vertically
  axis = &quot;lr&quot;, # only by their left and right margins
  ncol = 1     # allow only one column
)</code></pre>
<pre><code>## Error in stop_if_not_aweek_string(x): aweek strings must match the pattern &#39;YYYY-Www-d&#39;. The first incorrect string was: &#39;(Missing)&#39;</code></pre>
</div>
<div id="admission-and-exits-by-epiweek" class="section level4">
<h4>Admission and exits by epiweek</h4>
<p>This next code chunk describes each epiweek’s admission by their case definition status. It uses <code>tab_linelist()</code> again to look at <code>linelist_cleaned</code>, with rows as <code>epiweek</code>, and columns as <code>case_def</code>, with row and column totals.</p>
<pre class="r"><code># get counts and props of admissions by epiweek and case definition 
# include column and row totals 
tab_linelist(linelist_cleaned, epiweek, strata = case_def,
             col_total = TRUE,
             row_total = TRUE) %&gt;% 
  select(-variable) %&gt;%
  rename_redundant(&quot;%&quot; = proportion) %&gt;%
  augment_redundant(&quot; (n)&quot; = &quot; n$&quot;) %&gt;%
  kable(digits = 1)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">value</th>
<th align="right">Confirmed (n)</th>
<th align="right">%</th>
<th align="right">Probable (n)</th>
<th align="right">%</th>
<th align="right">Suspected (n)</th>
<th align="right">%</th>
<th align="right">Missing (n)</th>
<th align="right">%</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2016-W23</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2016-W29</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.2</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2016-W30</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">3.6</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">2016-W33</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="right">1</td>
<td align="right">0.2</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">2016-W34</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0.4</td>
<td align="right">5</td>
<td align="right">17.9</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">2016-W35</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.2</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2016-W36</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.2</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">2016-W37</td>
<td align="right">9</td>
<td align="right">12.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">1.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td align="left">2016-W38</td>
<td align="right">5</td>
<td align="right">7.1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">1.0</td>
<td align="right">2</td>
<td align="right">7.1</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">2016-W39</td>
<td align="right">2</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0.6</td>
<td align="right">4</td>
<td align="right">14.3</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">2016-W40</td>
<td align="right">4</td>
<td align="right">5.7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0.6</td>
<td align="right">3</td>
<td align="right">10.7</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">2016-W41</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
<td align="right">7.1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">2016-W42</td>
<td align="right">2</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">2016-W43</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0.6</td>
<td align="right">1</td>
<td align="right">3.6</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">2016-W44</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">2016-W45</td>
<td align="right">2</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">2016-W46</td>
<td align="right">2</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">1.6</td>
<td align="right">2</td>
<td align="right">7.1</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">2016-W47</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">2.0</td>
<td align="right">3</td>
<td align="right">10.7</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">2016-W48</td>
<td align="right">2</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">20</td>
<td align="right">3.9</td>
<td align="right">1</td>
<td align="right">3.6</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">2016-W49</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="right">18</td>
<td align="right">3.5</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">19</td>
</tr>
<tr class="odd">
<td align="left">2016-W50</td>
<td align="right">2</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">30</td>
<td align="right">5.9</td>
<td align="right">3</td>
<td align="right">10.7</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">2016-W51</td>
<td align="right">3</td>
<td align="right">4.3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">19</td>
<td align="right">3.7</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">2016-W52</td>
<td align="right">4</td>
<td align="right">5.7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">3.6</td>
<td align="right">31</td>
</tr>
<tr class="even">
<td align="left">2017-W01</td>
<td align="right">3</td>
<td align="right">4.3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">13</td>
<td align="right">2.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="left">2017-W02</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">21</td>
<td align="right">4.1</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">2017-W03</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="right">12</td>
<td align="right">2.4</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">2017-W04</td>
<td align="right">3</td>
<td align="right">4.3</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="right">16</td>
<td align="right">3.1</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="left">2017-W05</td>
<td align="right">3</td>
<td align="right">4.3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">13</td>
<td align="right">2.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="left">2017-W06</td>
<td align="right">9</td>
<td align="right">12.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">109</td>
<td align="right">21.4</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="left">2017-W07</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">19</td>
<td align="right">3.7</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">2017-W08</td>
<td align="right">3</td>
<td align="right">4.3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">38</td>
<td align="right">7.5</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">41</td>
</tr>
<tr class="even">
<td align="left">2017-W09</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">15</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">2017-W10</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">38</td>
<td align="right">7.5</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="left">2017-W11</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">1.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">2017-W12</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">13</td>
<td align="right">2.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">2017-W13</td>
<td align="right">1</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">1.4</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">2017-W14</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">2.2</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">2017-W15</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0.6</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">2017-W16</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">1.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">Total</td>
<td align="right">70</td>
<td align="right">100.0</td>
<td align="right">4</td>
<td align="right">100</td>
<td align="right">509</td>
<td align="right">100.0</td>
<td align="right">28</td>
<td align="right">100.0</td>
<td align="right">611</td>
</tr>
</tbody>
</table>
<p>Finally, this produces the same table as above but uses <code>exit_status2</code> as the strata/column variable to display exits per epiweek. Note that this is also filtered to only include inpatient observations.</p>
<pre class="r"><code># get counts and props of admissions by epiweek among inpatients
# include column and row totals 
linelist_cleaned %&gt;% 
  filter(patient_facility_type == &quot;Inpatient&quot;) %&gt;%
  tab_linelist(epiweek, strata = exit_status2, 
               col_total = TRUE, row_total = TRUE) %&gt;% 
  select(-variable) %&gt;%
  rename(&quot;Week&quot; = value) %&gt;%
  rename_redundant(&quot;%&quot; = proportion) %&gt;%
  augment_redundant(&quot; (n)&quot; = &quot; n$&quot;) %&gt;%
  kable(digits = 1)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Week</th>
<th align="right">Dead (n)</th>
<th align="right">%</th>
<th align="right">Discharged (n)</th>
<th align="right">%</th>
<th align="right">Left (n)</th>
<th align="right">%</th>
<th align="right">Missing (n)</th>
<th align="right">%</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2016-W30</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2016-W33</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2016-W37</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
<td align="right">5.7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">14.3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">2016-W38</td>
<td align="right">1</td>
<td align="right">12.5</td>
<td align="right">2</td>
<td align="right">5.7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">2016-W39</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
<td align="right">5.7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">2016-W40</td>
<td align="right">1</td>
<td align="right">12.5</td>
<td align="right">4</td>
<td align="right">11.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">2016-W41</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">50</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2016-W42</td>
<td align="right">2</td>
<td align="right">25.0</td>
<td align="right">1</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">14.3</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">2016-W43</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2016-W44</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2016-W45</td>
<td align="right">2</td>
<td align="right">25.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">2016-W46</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">3</td>
<td align="right">8.6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">2016-W47</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2016-W48</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2016-W50</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2016-W51</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2016-W52</td>
<td align="right">1</td>
<td align="right">12.5</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">2017-W01</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">2.9</td>
<td align="right">1</td>
<td align="right">50</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">2017-W02</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2017-W03</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
<td align="right">5.7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">2017-W04</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">4</td>
<td align="right">11.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">2017-W05</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7.1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2017-W06</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">5</td>
<td align="right">14.3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">2017-W07</td>
<td align="right">1</td>
<td align="right">12.5</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2017-W08</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2017-W09</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2017-W10</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2017-W13</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
<td align="right">5.7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">2017-W14</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">2.9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Total</td>
<td align="right">8</td>
<td align="right">100.0</td>
<td align="right">35</td>
<td align="right">100.0</td>
<td align="right">2</td>
<td align="right">100</td>
<td align="right">14</td>
<td align="right">100.0</td>
<td align="right">59</td>
</tr>
</tbody>
</table>
</div>
</div>
